(() => {
    "use strict";
    (() => {

        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i)
            }
        }
        const t = function() {
            
            function t(e) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t), this.select = e, this.value = this.select.querySelector(".select__value"), this.menu = this.select.querySelector(".select__menu"), this.options = this.select.querySelectorAll(".select__menu .select__item"), this.input = this.select.querySelector(".select__input"), this.selectActiveClass = "select--isActive", this.menuActiveClass = "select__menu--isActive", this.init()
            }
            var n, i;
            return n = t, (i = [{
                key: "init",
                value: function() {
                    var e = this;
                    this.select.addEventListener("click", (function() {
                        return e.toggleMenu()
                    })), this.options.forEach((function(t) {
                        t.addEventListener("click", (function() {
                            return e.setValue(t)
                        }))
                    }));
                    var t = this.getValue();
                    if (t) {
                        var n = this.select.querySelector('[data-value="'.concat(t, '"]'));
                        this.setValue(n)
                    }
                }
            }, {
                key: "toggleMenu",
                value: function() {
                    this.select.classList.toggle(this.selectActiveClass), this.menu.classList.toggle(this.menuActiveClass)
                }
            }, {
                key: "setValue",
                value: function(e) {
                    var t = e.getAttribute("data-value"),
                        n = e.cloneNode(!0);
                    this.input && (this.input.value = t), this.select.setAttribute("data-value", t), this.value.innerHTML = "", this.value.appendChild(n)
                }
            }, {
                key: "getValue",
                value: function() {
                    return this.input ? this.input.value : this.select.getAttribute("data-value")
                }
            }]) && e(n.prototype, i), t
        }();
        var n = document.querySelector("#error-group"),
            i = document.querySelector("#error-text");

        function c(e) {
            if (!e) return n.style.display = "none", void(i.innerHTML = "");
            n.style.display = "", i.innerHTML = e
        }
        var s = !1,
            r = document.querySelector("#signInButton .button__text");

        function u(e) {
            s = e, e ? (r.innerHTML = "Espere, por favor", c("")) : (r.innerHTML = "Entrar")
        }

        var a, o = document.querySelector("#selectServer");
        o && (a = new t(o))
        var l = document.querySelector("#login_form");
        l.addEventListener("submit", (function(e) {
            if (a && (e.preventDefault(), !s)) {
                var t = new FormData(l);
                t.append("server", a.getValue()), u(!0), fetch("/engine/user/login.php", {
                    method: "POST",
                    body: t
                }).then((function(e) {
                    return e.json()
                })).then((function(e) {
                    if (u(!1), !e || !e.answer) return c("Problema de conexão com o servidor. Tente depois.");
                    
                    switch (e.answer) {
                        case "not_account":
                        case "not_pass":
                            c("Apelido ou senha incorretos. Verifique a exatidão dos dados inseridos.");
                            break;
                        case "not_gcode":
                            c("Um código de autenticação inválido foi inserido. Verifique a exatidão dos dados inseridos.");
                            break;
                        case "deactivated":
                            c("Sua conta foi desativada.");
                            break;
                        case "captcha":
                            c("Você não concluiu o captcha.")
                        case "sucess":
                            window.location = "/profile";
                    }

                })).catch((function(e) {
                    u(!1), c("Problema de conexão com o servidor. Tente depois.")
                }))
            }
        }))
    })()
})();